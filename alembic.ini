# alembic.ini â€” Detecktiv.io
# Starting from your file, filled in missing sections and kept your key settings.
# - Keeps script_location=db/migrations and version_table_schema=app
# - Leaves sqlalchemy.url UNSET; env.py should build it from DATABASE_URL / POSTGRES_* env vars
# - Adds sane logging config so `alembic` prints useful info

[alembic]
script_location = db/migrations
prepend_sys_path = .
version_table = alembic_version
version_table_schema = app
timezone = UTC
# Optional: file naming & encoding
file_template = %%(rev)s_%%(slug)s
output_encoding = utf-8

# Do NOT hardcode credentials here. env.py should set this from env vars.
# sqlalchemy.url =

[loggers]
keys = root,sqlalchemy,alembic

[handlers]
keys = console

[formatters]
keys = generic

[logger_root]
level = WARN
handlers = console

# Show executed SQL only if you need to debug migrations (set to INFO temporarily)
[logger_sqlalchemy]
level = WARN
handlers =
qualname = sqlalchemy.engine

[logger_alembic]
level = INFO
handlers = console
qualname = alembic

[handler_console]
class = StreamHandler
args = (sys.stderr,)
level = NOTSET
formatter = generic

[formatter_generic]
# Timestamped, compact log lines
format = %(asctime)s %(levelname)-5.5s [%(name)s] %(message)s
datefmt = %Y-%m-%d %H:%M:%S

# NOTES:
# - Ensure the "app" schema exists, or set POSTGRES_SCHEMA/ALEMBIC_SCHEMA to a schema that exists.
# - Typical env.py logic:
#     - If DATABASE_URL is set, use it;
#     - else, build a URL from POSTGRES_* variables and set config.set_main_option("sqlalchemy.url", url).
